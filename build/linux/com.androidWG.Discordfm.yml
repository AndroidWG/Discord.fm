app-id: com.androidWG.Discordfm
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
command: ./discord_fm
cleanup:
  - '/pyinstaller_temp'
  - '/venv'
finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=x11
  # Wayland access
  - --socket=wayland
  # Needs to talk to the network:
  - --share=network
modules:
  - name: discord_fm
    buildsystem: simple
    build-commands:
      - python3 -m venv venv
      - venv/bin/python -m pip install --no-build-isolation --exists-action=i --no-index --find-links="file://${PWD}"
        "wheel"
      - venv/bin/python -m pip install --no-build-isolation --exists-action=i --no-index --find-links="file://${PWD}"
        -r requirements.txt
      - venv/bin/python -O -m PyInstaller main.py --distpath '/app/bin' --icon=resources/icon.png --name=discord_fm --add-data=resources/black/.:resources/black --add-data=resources/white/.:resources/white --add-data=.env:. --additional-hooks-dir=hooks --workpath=pyinstaller_temp --upx-dir=upx/ -y --onefile --noconsole
      - venv/bin/python -O -m PyInstaller ui/ui.py --distpath '/app/bin' --icon=resources/settings.png --name=settings_ui --add-data=resources/black/.:resources/black --add-data=resources/white/./:resources/white --add-data=.env:. --additional-hooks-dir=hooks --workpath=pyinstaller_temp --noupx -y --windowed --onefile
    sources:
      - type: dir
        path: ../../
        skip:
          - build/
          - .*/
          - dist/
          - venv/
          - tests/
          - '*.md'
      - type: file
        url: https://files.pythonhosted.org/packages/c4/bf/8f56ebae9775a922774293f05235323b0c359dda5f07d6e81b726d6269b2/pypresence-4.2.1-py2.py3-none-any.whl
        sha256: 12197b5f51c21e3e555b17f85d3e55023f4ad83b6fff72cd6387659ffd484a02
      - type: file
        url: https://files.pythonhosted.org/packages/a5/d7/f8343ac23e8efe2f2065b58bbdd06c94725058261b0101a8cad0a50ededf/pylast-4.4.0-py3-none-any.whl
        sha256: 0b525a98b2b7b4dfb62ec6a30008b0e9bd10a53ef6cc75690132dab15823b33c
      - type: file
        url: https://files.pythonhosted.org/packages/3d/1e/8df97f56162b95026b1254610b82fb37ec32cca94ce000b2afba62fb2533/pystray-0.19.4-py2.py3-none-any.whl
        sha256: aeae1b62d8dbc5a6603fe5c018cddbdfadb0dc332cf7af0997b38ef9f0ceb71c
      - type: file
        url: https://files.pythonhosted.org/packages/8c/92/2975b464d9926dc667020ed1abfa6276e68c3571dcb77e43347e15ee9eed/Pillow-9.2.0.tar.gz
        sha256: 75e636fd3e0fb872693f23ccb8a5ff2cd578801251f3a4f6854c6a5d437d3c04
      - type: file
        url: https://files.pythonhosted.org/packages/d9/5a/e7c31adbe875f2abbb91bd84cf2dc52d792b5a01506781dbcf25c91daf11/six-1.16.0-py2.py3-none-any.whl
        sha256: 8abb2f1d86890a2dfb989f9a77cfcfd3e47c2a354b01111771326f8aa26e0254
      - type: file
        url: https://files.pythonhosted.org/packages/c2/16/950463d36e8b64067c4d535038c5512de8200015e793d7d0a3f400187cbf/python_xlib-0.31-py2.py3-none-any.whl
        sha256: 1ec6ce0de73d9e6592ead666779a5732b384e5b8fb1f1886bd0a81cafa477759
      - type: file
        url: https://files.pythonhosted.org/packages/45/0b/38b06fd9b92dc2b68d58b75f900e97884c45bedd2ff83203d933cf5851c9/future-0.18.2.tar.gz
        sha256: b1bead90b70cf6ec3f0710ae53a525360fa360d306a86583adc6bf83a4db537d
      - type: file
        url: https://files.pythonhosted.org/packages/e1/b0/7276de53321c12981717490516b7e612364f2cb372ee8901bd4a66a000d7/psutil-5.8.0.tar.gz
        sha256: 0c9ccb99ab76025f2f0bbecf341d4656e9c1351db8cc8a03ccd62e318ab4b5c6
      - type: file
        url: https://files.pythonhosted.org/packages/0e/f1/0317f4b2c5284075a2154fe95539b43c0acecbcb86fe80fcb2645803edd9/python_dotenv-0.19.2-py2.py3-none-any.whl
        sha256: 32b2bdc1873fd3a3c346da1c6db83d0053c3c62f28f1f38516070c4c8971b1d3
      - type: file
        url: https://files.pythonhosted.org/packages/75/6c/110c821dbedb3657e715bac48adc568c1a7e8347c73e6038d0c595280d63/PySide6-6.2.4-6.2.4-cp36.cp37.cp38.cp39.cp310-abi3-manylinux1_x86_64.whl
        sha256: 4656853a34bea096bb0a1f74e22607f99cca6e68d55a4f86a73770c5ec74565e
      - type: file
        url: https://files.pythonhosted.org/packages/89/d0/59e7c52f5af5bc97142edc61a5d2437b8c81b943c7d2a8ee98acf85273b7/shiboken6-6.2.4-6.2.4-cp36.cp37.cp38.cp39.cp310-abi3-manylinux1_x86_64.whl
        sha256: 05f4652dda7043b1a04265cabc1709c22d643d204fac2c4b0ccf7d0044092c62
      - type: file
        url: https://files.pythonhosted.org/packages/68/47/93d3d28e97c7577f563903907912f4b3804054e4877a5ba6651f7182c53b/urllib3-1.26.10-py2.py3-none-any.whl
        sha256: 8298d6d56d39be0e3bc13c1c97d133f9b45d797169a0e11cdd0e0489d786f7ec
      - type: file
        url: https://files.pythonhosted.org/packages/04/a2/d918dcd22354d8958fe113e1a3630137e0fc8b44859ade3063982eacd2a4/idna-3.3-py3-none-any.whl
        sha256: 84d9dd047ffa80596e0f246e2eab0b391788b0503584e8945f2368256d2735ff
      - type: file
        url: https://files.pythonhosted.org/packages/e9/06/d3d367b7af6305b16f0d28ae2aaeb86154fa91f144f036c2d5002a5a202b/certifi-2022.6.15-py3-none-any.whl
        sha256: fe86415d55e84719d75f8b69414f6438ac3547d2078ab91b67e779ef69378412
      - type: file
        url: https://files.pythonhosted.org/packages/92/96/144f70b972a9c0eabbd4391ef93ccd49d0f2747f4f6a2a2738e99e5adc65/requests-2.26.0-py2.py3-none-any.whl
        sha256: 6c1246513ecd5ecd4528a0906f910e8f0f9c6b8ec72030dc9fd154dc1a6efd24
      - type: file
        url: https://files.pythonhosted.org/packages/06/b3/24afc8868eba069a7f03650ac750a778862dc34941a4bebeb58706715726/charset_normalizer-2.0.12-py3-none-any.whl
        sha256: 6881edbebdb17b39b4eaaa821b438bf6eddffb4468cf344f09f89def34a8b1df
      - type: file
        url: https://files.pythonhosted.org/packages/05/8e/8de486cbd03baba4deef4142bd643a3e7bbe954a784dc1bb17142572d127/packaging-21.3-py3-none-any.whl
        sha256: ef103e05f519cdc783ae24ea4e2e0f508a9c99b2d4969652eed6a2e1ea5bd522
      - type: file
        url: https://files.pythonhosted.org/packages/6c/10/a7d0fa5baea8fe7b50f448ab742f26f52b80bfca85ac2be9d35cdd9a3246/pyparsing-3.0.9-py3-none-any.whl
        sha256: 5026bae9a10eeaefb61dab2f09052b9f4307d44aee4eda64b309723d8d206bbc
      - type: file
        url: https://files.pythonhosted.org/packages/26/b1/23800271e74bf5ce54e124df0c495506bb9857d05f63cf6bc3ce4d89f5c9/plyer-2.0.0-py2.py3-none-any.whl
        sha256: d62a1e68622042e6b9367ba429844e989ea7b13035fd1befe66f385aaaba6de1
      - type: file
        url: https://files.pythonhosted.org/packages/ca/6c/ab2f79146ca546875e2a633d21e968acc17042ce88e4413b340541f0d4c5/filelock-3.4.2-py3-none-any.whl
        sha256: cf0fc6a2f8d26bd900f19bf33915ca70ba4dd8c56903eeb14e1e7a2fd7590146
      - type: file
        url: https://files.pythonhosted.org/packages/27/d6/003e593296a85fd6ed616ed962795b2f87709c3eee2bca4f6d0fe55c6d00/wheel-0.37.1-py2.py3-none-any.whl
        sha256: 4bdcd7d840138086126cd09254dc6195fb4fc6f01c050a1d7236f2630db1d22a
      - type: file
        url: https://files.pythonhosted.org/packages/84/3f/1a5c9bef54cac9bf41edd6f4aaf61cd52ed578e10ccc607e0278012cb4a5/altgraph-0.17.2-py2.py3-none-any.whl
        sha256: 743628f2ac6a7c26f5d9223c91ed8ecbba535f506f4b6f558885a8a56a105857
      - type: file
        url: https://files.pythonhosted.org/packages/3d/fb/8ab57519f2c44efe3476eb06961ee42a87d0d21d75a01aa349fa407b29a7/pyinstaller_hooks_contrib-2022.8-py2.py3-none-any.whl
        sha256: e46f099934dd4577fb1ddcf37a99fa04027c92f8f5291c8802f326345988d001
      - type: file
        url: https://files.pythonhosted.org/packages/9c/b1/5c9cf5bceade92613196b1be4b9cc1406e82d9edadb3c682da860be96cea/pyinstaller-5.2.tar.gz
        sha256: 5efc1b3ffb13fe50a51305fe57fb9e6e7bce00d009c16dd3cb76ea4d702a04ab